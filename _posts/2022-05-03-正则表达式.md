---
layout:     post
title:      正则表达式
subtitle:   完成中...
date:       2022-05-03
author:     Pele
header-img: img/pic/post-bg-learning.jpg
catalog: true
tags:
    - 学习
---
# 正则表达式

![2183122778](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202205021615914.jpeg)

> 正则表达式是由普通字符（例如字符 a 到 z）以及特殊字符（称为"元字符"）组成的文字模式。模式描述**在搜索文本时要匹配的一个或多个字符串**。正则表达式作为一个模板，将某个字符模式与所搜索的字符串进行匹配。



### 示例

#### 手机号正则表达式

```latex
^1[34578][0-9]{9}$
```

其中符号 `^`与`$` 为元字符，它有特殊的定义，`[]`用以分组，`{}`用以表示重复，在这里则表示该分组[0-9]重复的次数为9次；



辅助理解正则表达的在线工具 [regexper.com](https://link.juejin.cn/?target=https%3A%2F%2Fregexper.com%2F)   利用这个工具辅助理解正则表达式



以137开头，89结尾的电话号码

```latex
^137\d{6}89$
```



### 入门

假设你需要查找一篇英文文章中的hi，那么你可以使用正则表达式`hi`。

这几乎算是最简单的正则表达式了，它可以精确匹配这样的字符串：由两个字符组成，前一个字符是`h`,后一个是`i`.通常，处理正则表达式的工具会提供一个忽略大小写的选项，如果选中了这个选项，它可以匹配*hi,HI,Hi,hI*这四种情况中的任意一种。  

不幸的是，很多单词里包含*hi*这两个连续的字符，比如*him,history,high*等等。用`hi`来查找的话，这里边的*hi*也会被找出来。如果要精确地查找hi这个单词的话，我们应该使用`\bhi\b`。

假如你要找的是hi后面不远处跟着一个Lucy，你应该用`\bhi\b.*\bLucy\b`

这里，`.`是另一个元字符，匹配除了换行符以外的任意字符。`*`同样是元字符，不过它代表的不是字符，也不是位置，而是数量——它指定*前边的内容可以连续重复使用任意次以使整个表达式得到匹配。因此，`.*`连在一起就意味着任意数量的不包含换行的字符。现在`\bhi\b.*\bLucy\b`的意思就很明显了：先是一个单词hi,然后是任意个任意字符(但不能是换行)，最后是Lucy这个单词。

```latex
^\bhi.*Lucy\b$
```

![image](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202205021644112.png)

`0\d\d-\d\d\d\d\d\d\d\d`匹配这样的字符串：以0开头，然后是两个数字，然后是一个连字号“-”，最后是8个数字

为了避免那么多烦人的重复，我们也可以这样写这个表达式：`0\d{2}-\d{8}`。这里`\d`后面的`{2}`(`{8}`)的意思是前面`\d`必须连续重复匹配2次(8次)





### 常用的元字符

| 代码 |            说明            |
| :--: | :------------------------: |
| `.`  | 匹配除换行符以外的任意字符 |
| `\w` |   匹配字母或数字或下划线   |
| `\s` |      匹配任意的空白符      |
| `\d` |          匹配数字          |
| `\b` |    匹配单词的开始或结束    |
| `^`  |      匹配字符串的开始      |
| `$`  |      匹配字符串的结束      |



### 字符转义

| 代码/语法 |       说明       |
| :-------: | :--------------: |
|    `*`    | 重复零次或更多次 |
|    `+`    | 重复一次或更多次 |
|    `?`    |  重复零次或一次  |
|   `{n}`   |     重复n次      |
|  `{n,}`   | 重复n次或更多次  |
|  `{n,m}`  |    重复n到m次    |

下面是一些使用重复的例子：

`Windows\d+`匹配Windows后面跟1个或更多数字

`^\w+`匹配一行的第一个单词(或整个字符串的第一个单词，具体匹配哪个意思得看选项设置)



### 字符类

要想匹配像元音字母a，e，i，o，u这些没有预先定义元字符的字符集合该怎么做呢？

有个很简单的方法，只需要在方括号里列出它们就可以了，像`[aeiou]`就匹配任何一个英文元音字母，`[.?!]`匹配标点符号(.或?或!)。

我们也可以轻松地指定一个字符**范围**，像`[0-9]`代表的含意与`\d`就是完全一致的：一位数字；同理`[a-z0-9A-Z_]`也完全等同于`\w`（如果只考虑英文的话）

```latex
\(? 0 \d{2} [) -]? \d{8}
```

这个表达式可以匹配几种格式的电话号码，像(010)88886666，或022-22334455，或02912345678等。我们对它进行一些分析吧：首先是一个转义字符`\(`,它能出现0次或1次(`?`),然后是一个`0`，后面跟着2个数字(`\d{2}`)，然后是`)`或`-`或`空格`中的一个，它出现1次或不出现(`?`)，最后是8个数字(`\d{8}`)



### 分枝条件

但是在上节内容介绍的那个表达式也可以用来匹配类似*010)12345678*或*(022-87654321*这样的错误的格式。怎么办？要想解决这个问题，我们可以使用**分枝条件。**正则表达式里的**分枝条件**指的是有几种规则，只要满足这些规则中的任意一种，都会被当成匹配，因此我们要使用` | `把这些规则分开。为了更好的理解上述内容，我们来看看几个例子：

`0\d{2}-\d{8}|0\d{3}-\d{7}`这个表达式能匹配两种以连字号分隔的电话号码：一种是三位区号，8位本地号(如010-12345678)，一种是4位区号，7位本地号(0376-2233445)。

```latex
\(0\d{2}\)[- ]?\d{8}|0\d{2}[- ]?\d{8}
```

这个表达式匹配3位区号的电话号码，其中区号可以用小括号括起来，也可以不用，区号与本地号间可以用连字号或空格间隔，也可以没有间隔。你可以试试用分枝条件把这个表达式扩展成也支持4位区号的。

`\d{5}-\d{4}|\d{5}`这个表达式用于匹配美国的邮政编码。美国邮编的规则是5位数字，或者用连字号间隔的9位数字。

![image](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202205031702562.svg)

之所以要给出这个例子是因为它能说明一个问题：**使用分枝条件时，要注意各个条件的顺序**。如果你把它改成`\d{5}|\d{5}-\d{4}`的话，那么就只会匹配5位的邮编(以及9位邮编的前5位)。原因是匹配分枝条件时，将会从左到右地测试每个条件，如果满足了某个分枝的话，就不会去再管其它的条件了。



### 分组

在字符后面加上限定符就可以重复单个字符，那么多个字符的重复又该如何实现呢？可以使用小括号来指定子表达式（也称为**分组**），然后对于这个子表达式的重复次数你就可以自行规定了，子表达式也可以进行一些其他的操作，这个在后面会进行介绍。

`(\d{1,3}\.){3}\d{1,3}`是一个简单的IP地址匹配表达式。
要理解这个表达式，请按下列顺序分析它：

1. `\d{1,3}`匹配1到3位的数字
2. `(\d{1,3}\.){3}`匹配三位数字加上一个英文句号(这个整体也就是这个**分组**)重复3次
3. 最后再加上一个一到三位的数字`(\d{1,3})`

不幸的是，它也将匹配256.300.888.999这种*不可能存在*的IP地址。如果能使用算术比较的话，或许能简单地解决这个问题，但是正则表达式中并不提供关于数学的任何功能，所以只能使用冗长的分组，选择，字符类来描述一个正确的IP地址：

```latex 
((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)
```

理解这个表达式的关键是理解`2[0-4]\d|25[0-5]|[01]?\d\d?`

1. `2[0-4]\d`  == 200~249
2. `25[0-5]` == 250~255
3. `[01]?\d\d?` == 0~199

![image (1)](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202205041844867.svg)

**注解：**

1. IP地址中每个数字都不能大于255? 01.02.03.04 这样前面带有0的数字, 是不是正确的IP地址呢? 

   答案是: **是的**, IP 地址里的数字可以包含有前导 0 (leading zeroes).



### 反义

有时需要查找不属于某个能简单定义的字符类的字符。比如想查找除了数字以外，其它任意字符都行的情况，这时需要用到**反义**：

| 代码/语法  |                    说明                    |
| :--------: | :----------------------------------------: |
|    `\W`    | 匹配任意不是字母，数字，下划线，汉字的字符 |
|    `\S`    |          匹配任意不是空白符的字符          |
|    `\D`    |            匹配任意非数字的字符            |
|    `\B`    |        匹配不是单词开头或结束的位置        |
|   `[^x]`   |          匹配除了x以外的任意字符           |
| `[^aeiou]` |   匹配除了aeiou这几个字母以外的任意字符    |

例子：`\S+`匹配不包含空白符的字符串。

`<a[^>]+>`匹配用尖括号括起来的以a开头的字符串。

![image (2)](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202205041859317.svg)



### 后向引用

