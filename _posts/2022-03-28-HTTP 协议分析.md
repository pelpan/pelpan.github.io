---
layout:     post
title:      HTTPåè®®åˆ†æ
subtitle:   TCP/IPåè®®
date:       2022-03-28
author:     Pele
header-img: img/bg-http.jpeg
catalog: true
tags:
    - TCP/IP
---


# HTTP åè®®åˆ†æ

> **è¶…æ–‡æœ¬ä¼ è¾“åè®®**ï¼ˆè‹±è¯­ï¼š**H**yper**T**ext **T**ransfer **P**rotocolï¼Œç¼©å†™ï¼š**HTTP**ï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ã€åä½œå¼å’Œ[è¶…åª’ä½“](https://zh.wikipedia.org/wiki/è¶…åª’é«”)ä¿¡æ¯ç³»ç»Ÿçš„[åº”ç”¨å±‚](https://zh.wikipedia.org/wiki/åº”ç”¨å±‚)[åè®®](https://zh.wikipedia.org/wiki/ç½‘ç»œä¼ è¾“åè®®)[[1\]](https://zh.wikipedia.org/wiki/è¶…æ–‡æœ¬ä¼ è¾“åè®®#cite_note-ietf2616-1)ã€‚HTTPæ˜¯[ä¸‡ç»´ç½‘](https://zh.wikipedia.org/wiki/å…¨çƒè³‡è¨Šç¶²)çš„æ•°æ®é€šä¿¡çš„åŸºç¡€ã€‚ â€”â€” Wikipedia

å°½ç®¡[TCP/IP](https://zh.wikipedia.org/wiki/TCP/IP)åè®®æ˜¯äº’è”ç½‘ä¸Šæœ€æµè¡Œçš„åº”ç”¨ï¼Œä½†æ˜¯åœ¨HTTPåè®®ä¸­å¹¶æ²¡æœ‰è§„å®šå®ƒå¿…é¡»ä½¿ç”¨æˆ–å®ƒæ”¯æŒçš„å±‚ã€‚äº‹å®ä¸ŠHTTPå¯ä»¥åœ¨ä»»ä½•äº’è”ç½‘åè®®æˆ–å…¶ä»–ç½‘ç»œä¸Šå®ç°ã€‚HTTPå‡å®šå…¶ä¸‹å±‚åè®®æä¾›å¯é çš„ä¼ è¾“ã€‚å› æ­¤ï¼Œä»»ä½•èƒ½å¤Ÿæä¾›è¿™ç§ä¿è¯çš„åè®®éƒ½å¯ä»¥è¢«å…¶ä½¿ç”¨ï¼Œæ‰€ä»¥å…¶åœ¨TCP/IPåè®®æ—ä½¿ç”¨TCPä½œä¸ºå…¶ä¼ è¾“å±‚ã€‚

### è¯·æ±‚æ–¹æ³•

+ GET â€”â€” å‘æŒ‡å®šçš„èµ„æºå‘å‡ºâ€œæ˜¾ç¤ºâ€è¯·æ±‚ã€‚
+ HEAD â€”â€” ä¸GETæ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯å‘æœåŠ¡å™¨å‘å‡ºæŒ‡å®šèµ„æºçš„è¯·æ±‚ã€‚åªä¸è¿‡æœåŠ¡å™¨å°†ä¸ä¼ å›èµ„æºçš„æœ¬æ–‡éƒ¨åˆ†ã€‚
+ POST â€”â€” å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®ï¼Œè¯·æ±‚æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚æœ¬æ–‡ä¸­ã€‚è¿™ä¸ªè¯·æ±‚å¯èƒ½ä¼šåˆ›å»ºæ–°çš„èµ„æºæˆ–ä¿®æ”¹ç°æœ‰èµ„æºï¼Œæˆ–äºŒè€…çš†æœ‰ã€‚
+ CONNECT â€”â€” HTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºéš§é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚é€šå¸¸ç”¨äºSSLåŠ å¯†æœåŠ¡å™¨çš„é“¾æ¥ï¼ˆç»ç”±éåŠ å¯†çš„HTTPä»£ç†æœåŠ¡å™¨ï¼‰ã€‚

**HTTPæœåŠ¡å™¨è‡³å°‘åº”è¯¥å®ç°GETå’ŒHEADæ–¹æ³•**ï¼Œå…¶ä»–æ–¹æ³•éƒ½æ˜¯å¯é€‰çš„ã€‚å½“ç„¶ï¼Œæ‰€æœ‰çš„æ–¹æ³•æ”¯æŒçš„å®ç°éƒ½åº”å½“ç¬¦åˆä¸‹è¿°çš„æ–¹æ³•å„è‡ªçš„è¯­ä¹‰å®šä¹‰ã€‚



#### HTTP ç‰ˆæœ¬è¿­ä»£

##### HTTP/0.9

å·²è¿‡æ—¶ã€‚åªæ¥å—GETä¸€ç§è¯·æ±‚æ–¹æ³•ï¼Œæ²¡æœ‰åœ¨é€šè®¯ä¸­æŒ‡å®šç‰ˆæœ¬å·ï¼Œä¸”ä¸æ”¯æŒè¯·æ±‚å¤´ã€‚ç”±äºè¯¥ç‰ˆæœ¬ä¸æ”¯æŒPOSTæ–¹æ³•ï¼Œå› æ­¤å®¢æˆ·ç«¯æ— æ³•å‘æœåŠ¡å™¨ä¼ é€’å¤ªå¤šä¿¡æ¯ã€‚

##### HTTP/1.0

è¿™æ˜¯ç¬¬ä¸€ä¸ªåœ¨é€šè®¯ä¸­æŒ‡å®šç‰ˆæœ¬å·çš„HTTPåè®®ç‰ˆæœ¬ã€‚

##### HTTP/1.1

é»˜è®¤é‡‡ç”¨æŒç»­è¿æ¥ï¼ˆConnection: keep-aliveï¼‰ï¼Œèƒ½å¾ˆå¥½åœ°é…åˆä»£ç†æœåŠ¡å™¨å·¥ä½œã€‚è¿˜æ”¯æŒä»¥[ç®¡é“æ–¹å¼](https://zh.wikipedia.org/wiki/HTTPç®¡çº¿åŒ–)åœ¨åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚ï¼Œä»¥ä¾¿é™ä½çº¿è·¯è´Ÿè½½ï¼Œæé«˜ä¼ è¾“é€Ÿåº¦ã€‚

HTTP/1.1ç›¸è¾ƒäºHTTP/1.0åè®®çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ï¼š

+ ç¼“å­˜å¤„ç†
+ å¸¦å®½ä¼˜åŒ–åŠç½‘ç»œè¿æ¥çš„ä½¿ç”¨
+ é”™è¯¯é€šçŸ¥çš„ç®¡ç†
+ æ¶ˆæ¯åœ¨ç½‘ç»œä¸­çš„å‘é€
+ äº’è”ç½‘åœ°å€çš„ç»´æŠ¤
+ å®‰å…¨æ€§åŠå®Œæ•´æ€§

##### HTTP/2

å½“å‰ç‰ˆæœ¬ï¼Œäº2015å¹´5æœˆä½œä¸ºäº’è”ç½‘æ ‡å‡†æ­£å¼å‘å¸ƒã€‚



### HTTP çŠ¶æ€ç 

**å“åº”ç±»å‹**

| çŠ¶æ€ç±»å‹ | ä¿¡æ¯                                      |
| -------- | ----------------------------------------- |
| 1xx      | æŒ‡ç¤ºä¿¡æ¯â€“è¡¨ç¤ºè¯·æ±‚å·²æ¥æ”¶ï¼Œç»§ç»­å¤„ç†ã€‚       |
| 2xx      | æˆåŠŸâ€“è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ã€ç†è§£ã€æ¥å—ã€‚   |
| 3xx      | é‡å®šå‘â€“è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ“ä½œã€‚ |
| 4xx      | å®¢æˆ·ç«¯é”™è¯¯â€“è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®ç°ã€‚ |
| 5xx      | æœåŠ¡å™¨ç«¯é”™è¯¯â€“æœåŠ¡å™¨æœªèƒ½å®ç°åˆæ³•çš„è¯·æ±‚ã€‚   |

| å¸¸è§çŠ¶æ€ç                 |                                                              |
| ------------------------- | ------------------------------------------------------------ |
| 200 OK                    | å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ                                               |
| 400 Bad Request           | å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£                     |
| 401 Unauthorized          | è¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’ŒWWW-AuthenticateæŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨ |
| 403 Forbidden             | æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡                             |
| 404 Not Found             | è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œä¸¾ä¸ªä¾‹å­ï¼šè¾“å…¥äº†é”™è¯¯çš„URL                    |
| 500 Internal Server Error | æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯                                     |
| 503 Server Unavailable    | æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸       |

### æŒç»­è¿çº¿

[![ä½¿ç”¨å¤šä¸ªé“¾æ¥å’Œä½¿ç”¨æŒä¹…é“¾æ¥çš„å¯¹æ¯”](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281626822.png)](https://zh.wikipedia.org/w/index.php?title=File:HTTP_persistent_connection.svg&lang=zh)

åœ¨HTTP 0.9å’Œ1.0ä¸­ï¼Œ[TCPè¿æ¥](https://zh.wikipedia.org/wiki/ä¼ è¾“æ§åˆ¶åè®®)åœ¨æ¯ä¸€æ¬¡è¯·æ±‚/å›åº”å¯¹ä¹‹åå…³é—­ã€‚åœ¨HTTP 1.1ä¸­ï¼Œå¼•å…¥äº†ä¿æŒè¿çº¿çš„æœºåˆ¶ï¼Œä¸€ä¸ªè¿æ¥å¯ä»¥é‡å¤åœ¨å¤šä¸ªè¯·æ±‚/å›åº”ä½¿ç”¨ã€‚æŒç»­è¿çº¿çš„æ–¹å¼å¯ä»¥å¤§å¤§å‡å°‘[ç­‰å¾…æ—¶é—´](https://zh.wikipedia.org/wiki/å»¶è¿Ÿ_(å·¥ç¨‹å­¦))ï¼Œå› ä¸ºåœ¨å‘å‡ºç¬¬ä¸€ä¸ªè¯·æ±‚åï¼ŒåŒæ–¹ä¸éœ€è¦é‡æ–°æ‰§è¡Œ[TCPæ¡æ‰‹ç¨‹åº](https://zh.wikipedia.org/wiki/æ¡æ‰‹_(æŠ€æœ¯))ã€‚







## æŠ“åŒ…åˆ†æ

å»ºç«‹TCPé“¾æ¥

ä¸‰æ¬¡æ¡æ‰‹ğŸ¤

![image-20220328184450099](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281844262.png)



### è¯·æ±‚å¤´

#### GET

![image-20220328184929273](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281849345.png)

+ è¯·æ±‚æ–¹å¼ GET
+ Host: log.people.cn
+ User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36 Edg/96.0.1054.62
+ Accept: \*/\* æ¥å—æ‰€æœ‰ç±»å‹
+ Accept-Encoding: gzip, deflate æ¥å—çš„ç¼–ç ç±»å‹
+ Accept-Language: zh-CN,zh;q=0.9, en;q=0.8, en-GB;q=0.7, en-US;q=0.6 å¯¹ä¸åŒè¯­è¨€çš„åå¥½
+ If-Modified-Since:Fri, 24 Dec 2021 03:27:02 GMT æœåŠ¡å™¨æ–‡ä»¶ä¸Šæ¬¡ä¿®æ”¹æ—¶é—´
+ Referer: http://www.people.com.cn



#### POST

![image-20220328190531290](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281905357.png)

+ è¯·æ±‚ç±»å‹ï¼šPOST
+ Host: search.people.cn
+ Content-Length: 145 å†…å®¹é•¿åº¦ 145å­—èŠ‚
+ Accept: application/json, text/plain,\*/*
+ Content-Type: application/json  å†…å®¹ç±»å‹ä¸ºåº”ç”¨æ•°æ®ï¼Œæ ¼å¼ä¸ºjson
+ åŒ…å†…åŒ…å«äº†ä¸€ä¸ªå¤§å°ä¸º145bytesçš„jsonæ–‡ä»¶ï¼Œå‘é€è¦æœç´¢çš„æ•°æ®ä¿¡æ¯



### å“åº”å¤´

![image-20220328191533727](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281915871.png)

+ çŠ¶æ€ç : 200

+ Response Phrase: OK

  è¯·æ±‚æˆåŠŸ

+ Connection: Keep-alive

+ Content-Encoding: gzip  å†…å®¹ç¼–ç  gzip

+ Content-Type: text/html  å†…å®¹æ ¼å¼ text/html

+ Dateï¼šMon, 28 Mar 2022  16:29:49 GMT

+ Server:nginx  æœåŠ¡å™¨è¿è¡Œçš„ç³»ç»Ÿ

+ Varyï¼šAccept-Encoding  ä»£è¡¨åœ¨ä¸‹æ¬¡çš„è¯·æ±‚å¤´ä¸­è¿˜éœ€åŒ…å«Accept-Encodingæ¡ç›®



![image-20220328192352842](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281923942.png)

+ çŠ¶æ€ç ï¼š403 Forbidden
+ Transfer-Encoding: chunked  
  - Transfer-Encoding æŒ‡æ˜äº†å°†å®ä½“æŠ¥æ–‡å®‰å…¨ä¼ é€’ç»™ç”¨æˆ·æ‰€é‡‡ç”¨çš„ç¼–ç å½¢å¼ã€‚
  - chunkedæŒ‡æ•°æ®ä»¥ä¸€ç³»åˆ—åˆ†å—çš„å½¢å¼è¿›è¡Œå‘é€ã€‚ [`Content-Length`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Length) é¦–éƒ¨åœ¨è¿™ç§æƒ…å†µä¸‹ä¸è¢«å‘é€ã€‚





#### Node.js å®ç°

åˆšå¥½æœ€è¿‘åœ¨å­¦Node.jsï¼Œ å°è¯•ä½¿ç”¨node.js é…ç½®æœåŠ¡å™¨åç«¯å“åº”ã€‚



##### **å¯¹GETè¯·æ±‚çš„å“åº”**

![image-20220328193150881](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281931000.png)

åˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„å¯¹GETè¯·æ±‚çš„å“åº”ï¼Œå½“æ”¶åˆ°GETè¯·æ±‚æ—¶è¿”å›ä¸€ä¸ªtextæ–‡ä»¶

<img src="https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281934711.png" alt="image-20220328193445652" style="zoom: 67%;" />

ä½¿ç”¨ API Tester å‘ `127.0.0.1:3000`ç«¯å£å‘é€ä¸€ä¸ªGETè¯·æ±‚

å¯ä»¥å‘åˆ°è¿”å›çš„å†…å®¹ä¸ºä¸€ä¸ªtextï¼Œé•¿åº¦ä¸º11å­—èŠ‚



##### **è·å–æœåŠ¡å™¨ä¸­çš„æ–‡ä»¶**

![image-20220328195259155](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281952304.png)

![image-20220328195520799](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203281955894.png)

åˆ¤æ–­é€»è¾‘ä¸ºï¼Œå‘æœåŠ¡å™¨å‘é€GETè¯·æ±‚ï¼Œå¦‚æœè¯¥ç”¨æˆ·å­˜åœ¨ï¼Œä¼šè¿”å›ç”¨æˆ·åå¯¹åº”çš„jsonæ–‡ä»¶ï¼Œå¦‚æœdataä¸­æ²¡æœ‰è¯¥ç”¨æˆ·çš„ä¿¡æ¯ï¼Œåˆ™è¿”å›404é”™è¯¯ï¼Œæç¤ºâ€˜no userâ€™

+ ä¸å­˜åœ¨çš„ç”¨æˆ·åï¼Œè¿”å›404é”™è¯¯ç 

  ![](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203282002237.png)

+ å­˜åœ¨çš„ç”¨æˆ·ï¼Œè¿”å›å¯¹åº”çš„jsonæ–‡ä»¶

  ![image-20220328200335934](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203282003031.png)





##### å¯¹POSTè¯·æ±‚çš„å“åº”

![image-20220329074753862](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203290747906.png)

+ å¦‚æœè¯·æ±‚ä¸ºPOSTï¼Œå¹¶ä¸”è®¿é—®çš„è·¯å¾„ä¸º`api/v1/user`è¿›å…¥å‡½æ•°è§£æ

+ å¦‚æœæ•°æ®æ ¡éªŒå‡ºé”™ï¼Œè¿”å›çŠ¶æ€ç   422 ï¼Œæç¤º``name required`

+ å¦‚æœè¯·æ±‚æ­£ç¡®ï¼Œä¸”æ•°æ®ç¬¦åˆè¦æ±‚ï¼Œè¿”å›çŠ¶æ€ç 200,å¹¶ä¸”è¿”å›ä¸€ä¸ªjsonæ–‡ä»¶ï¼Œå†…å®¹ä¸º

  ```json
  {
    "success": true
  }
  ```

+ å…¶ä»–æƒ…å†µï¼Œè°ƒç”¨é”™è¯¯å¤„ç†å‡½æ•°å…œåº•ï¼Œè¿”å›é”™è¯¯ç 400



##### **æµ‹è¯•**

![image-20220329110859327](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203291108383.png)

å‘é€ä¸€ä¸ªbodyä¸ºç©ºçš„POSTè¯·æ±‚ï¼ŒæœåŠ¡å™¨å“åº”`422 name required`,è¯´æ˜ç¼ºå°‘å†…å®¹

![image-20220329111037617](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203291110702.png)

è®¿é—®å…¶ä»–è·¯å¾„ï¼Œè¿”å›`400 Error`

![image-20220329111223843](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203291112926.png)

å‘é€ä¸€ä¸ªPOSTæŠ¥æ–‡ï¼ŒbodyåŒ…å«ä¸€ä¸ªjsonå­—æ®µ

![image-20220329111317139](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203291113232.png)

åœ¨è¯·æ±‚æŠ¥æ–‡çš„å¤´éƒ¨åŠ å…¥Content-Typeä¸º jsonç±»å‹

æœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯ä¸º

```json
{"success":true}
```

![image-20220329111429591](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203291114719.png)

![image-20220329111513944](https://pele-images.oss-cn-hangzhou.aliyuncs.com/images/202203291115053.png)

åœ¨æœ¬åœ°çš„dataæ–‡ä»¶å¤¹ä¸­æˆåŠŸåˆ›å»ºäº†åä¸º`pqq.json`çš„æ–‡ä»¶